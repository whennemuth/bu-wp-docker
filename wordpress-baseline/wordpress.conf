<VirtualHost *:80>
  ServerName localhost
  ServerAdmin webmaster@localhost
  DocumentRoot /var/www/html
  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined
    # Clear you browser cache or Redirect may not work.
  Redirect permanent / https://localhost/
</VirtualHost>

<VirtualHost *:443>
  ServerName localhost
  DocumentRoot /var/www/html
  LogLevel debug  
  LogLevel proxy:trace5  
  ErrorLog ${APACHE_LOG_DIR}/ssl-error.log
  CustomLog ${APACHE_LOG_DIR}/ssl-access.log combined
  # TransferLog /dev/stdout

  SetEnv TZ UTC

  SSLCertificateFile	/etc/ssl/certs/ssl-cert-snakeoil.pem
  SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key
  SSLEngine on
  SSLProxyEngine On

  # UseCanonicalName On

  # All shibboleth generated links are to be handled by the shibboleth module
  <Location /Shibboleth.sso>
    SetHandler shib
  </Location>

  # index.htm alone should require a shib session.
  <Location "/">
    AuthType shibboleth
    ShibRequestSetting requireSession 1
    # Require shib-session
    Require valid-user
    ShibUseHeaders On
  </Location>

  # # index.htm alone should require a shib session.
  # <Location /index.htm>
  #   AuthType shibboleth
  #   ShibRequestSetting requireSession 1
  #   # Require shib-session
  #   Require valid-user
  #   ShibUseHeaders On
  # </Location>

  # # Anything other than index.htm should NOT require a session
  # <Location ~ "^/(?!index\.htm)">
  #   AuthType Shibboleth
  #   ShibRequestSetting requireSession false
  #   Require shibboleth
  #   ShibUseHeaders On
  # </Location>
  
</VirtualHost>